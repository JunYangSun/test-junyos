(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1755],{1309:(e,t,r)=>{"use strict";r.d(t,{default:()=>s,useLayoutData:()=>a});var n=r(1339);function a(){let e=(0,n.c)();return{brand:{name:e("common.brand"),href:"/"},navigation:[{name:e("nav.home"),href:"/"},{name:e("nav.profile"),href:"/profile"},{name:e("nav.list"),href:"/list"}],authButtons:{login:{text:e("common.login"),href:"/login"},register:{text:e("common.register"),href:"/register"}}}}let s=a},1377:(e,t,r)=>{"use strict";r.d(t,{N_:()=>s,a8:()=>i,rd:()=>l});var n=r(1077),a=r(7437);let{Link:s,redirect:o,usePathname:i,useRouter:l}=(0,n.A)({locales:a.IB,defaultLocale:a.q})},1687:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var n=r(5797),a=r(6275);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,n.$)(t))}},3041:(e,t,r)=>{"use strict";r.d(t,{L:()=>c,Jt:()=>m,gf:()=>l,LV:()=>u,bE:()=>g,WG:()=>d});let n={baseURL:"/api",timeout:3e4};async function a(e){if(!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));let t=e.headers.get("content-type");if(!t||!t.includes("application/json"))throw Error("响应不是 JSON 格式");let r=await e.json();if(200!==r.code&&0!==r.code){let e=Error(r.message||"请求失败");throw e.code=r.code,e.data=r.data,e}return r}var s=r(3143);let o="auth_token",i={set(e,t,r){let n="".concat(e,"=").concat(encodeURIComponent(t),"; path=/; SameSite=Lax");if(r){let e=Math.floor(24*r*3600);n+="; max-age=".concat(e);let t=new Date;t.setTime(t.getTime()+24*r*36e5),n+="; expires=".concat(t.toUTCString())}document.cookie=n},get(e){let t="".concat(e,"="),r=document.cookie.split(";");for(let e=0;e<r.length;e++){let n=r[e];for(;" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return null},remove(e){document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; max-age=0")}};function l(){return i.get(o)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:720;i.set(o,e,t/1440)}function c(){i.remove(o)}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:r="GET",headers:o={},searchParams:i,body:d,timeout:h=n.timeout,skipAuthRedirect:u=!1,showErrorToast:m=!0}=t,g=function(e,t){let r=n.baseURL;if(r.startsWith("/")&&((r=window.location.origin+r).endsWith("/")||(r+="/")),!r||r.startsWith("/")&&0){let n=r.endsWith("/")||e.startsWith("/")?"":"/",a=r+n+e;if(t){let e=new URLSearchParams;Object.entries(t).forEach(t=>{let[r,n]=t;e.append(r,String(n))});let r=e.toString();a+=r?"?".concat(r):""}return a}let a=new URL(e.startsWith("/")?e.slice(1):e,r);return t&&Object.entries(t).forEach(e=>{let[t,r]=e;a.searchParams.append(t,String(r))}),a.toString()}(e,i),f=l(),x={"Content-Type":"application/json",...o};f&&(x.Authorization="Bearer ".concat(f));let v={method:r,headers:x,credentials:"include"};d&&"GET"!==r&&(v.body=JSON.stringify(d));let b=new AbortController,p=setTimeout(()=>b.abort(),h);v.signal=b.signal;try{let e=await fetch(g,v);return await a(e)}catch(e){if(e instanceof Error){if(401===e.code&&(c(),u||(window.location.href="/login")),"AbortError"===e.name){let e=Error("请求超时，请稍后重试");throw m&&s.oR.error(e.message),e}m&&s.oR.error(e.message||"请求失败，请稍后重试")}throw e}finally{clearTimeout(p)}}async function u(e,t,r){return h(t,{method:e,searchParams:null==r?void 0:r.searchParams,body:null==r?void 0:r.body,...r})}async function m(e,t,r){return h(e,{method:"GET",searchParams:t,...r})}async function g(e,t,r){return h(e,{method:"POST",body:t,...r})}},3143:(e,t,r)=>{"use strict";r.d(t,{BO:()=>o,oR:()=>s});var n=r(8389);let a="app_toast",s={success:e=>{n.oR.success(e)},error:e=>{n.oR.error(e)},info:e=>{n.oR.info(e)},warning:e=>{n.oR.warning(e)},promise:n.oR.promise};function o(){var e;let t=null==(e=document.cookie.split("; ").find(e=>e.startsWith("".concat(a,"="))))?void 0:e.split("=")[1];if(t)try{let{type:e,message:r}=JSON.parse(decodeURIComponent(t));s[e](r),document.cookie="".concat(a,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/")}catch(e){console.error("Failed to parse toast cookie:",e)}}},3327:(e,t,r)=>{"use strict";r.d(t,{default:()=>N});var n=r(9700),a=r(1464),s=r(2557),o=r(338),i=r(1377),l=r(1339),d=r(538),c=r(2799),h=r(7544),u=r(5839),m=r(9530),g=r(429),f=r(263),x=r(6987),v=r(9264);let b={default:(0,o.default)(()=>r.e(7836).then(r.bind(r,5455)),{loadableGenerated:{webpack:()=>[5455]},loading:()=>(0,n.jsx)("div",{className:"h-12"})}),pill:(0,o.default)(()=>r.e(6528).then(r.bind(r,6528)),{loadableGenerated:{webpack:()=>[6528]},loading:()=>(0,n.jsx)("div",{className:"h-12"})}),underline:(0,o.default)(()=>r.e(9635).then(r.bind(r,9635)),{loadableGenerated:{webpack:()=>[9635]},loading:()=>(0,n.jsx)("div",{className:"h-12"})}),card:(0,o.default)(()=>r.e(5307).then(r.bind(r,5307)),{loadableGenerated:{webpack:()=>[5307]},loading:()=>(0,n.jsx)("div",{className:"h-12"})}),bottom:(0,o.default)(()=>r.e(6368).then(r.bind(r,6368)),{loadableGenerated:{webpack:()=>[6368]},loading:()=>(0,n.jsx)("div",{className:"h-14"})})};function p(e){let{items:t,activeKey:r,defaultActiveKey:s,onChange:o,mode:i="default",className:l}=e,d=function(e){var t;let{items:r,activeKey:n,defaultActiveKey:s,onChange:o}=e,[i,l]=(0,a.useState)(s||(null==(t=r[0])?void 0:t.key)||""),d=void 0!==n,c=d?n:i,h=(0,a.useCallback)(e=>{let t=r.find(t=>t.key===e);null!=t&&t.disabled||(d||l(e),null==o||o(e))},[r,d,o]);return{items:r,activeKey:c,onChange:h}}({items:t,activeKey:r,defaultActiveKey:s,onChange:o}),c=b[i]||b.default;return(0,n.jsx)(c,{data:d,className:l})}function j(){let e=(0,s.useRouter)(),t=(0,s.usePathname)(),r=[{key:"/",label:"首页",icon:(0,n.jsx)(g.A,{className:"h-5 w-5"})},{key:"/order",label:"订单",icon:(0,n.jsx)(f.A,{className:"h-5 w-5"})},{key:"/card",label:"省钱卡",icon:(0,n.jsx)(x.A,{className:"h-5 w-5"})},{key:"/profile",label:"我的",icon:(0,n.jsx)(v.A,{className:"h-5 w-5"})}];return(0,n.jsx)(p,{items:r,activeKey:(()=>{let e=r.find(e=>t===e.key);if(e)return e.key;let n=r.find(e=>"/"!==e.key&&t.startsWith(e.key));return n?n.key:"/"})(),onChange:t=>{e.push(t)},mode:"bottom"})}let k=(0,o.default)(()=>Promise.all([r.e(1247),r.e(8851),r.e(8629)]).then(r.bind(r,8629)),{loadableGenerated:{webpack:()=>[8629]},ssr:!1});function N(e){let{data:t}=e,r=(0,s.usePathname)(),[o,g]=(0,a.useState)(!1),{brand:f,navigation:x,authButtons:v}=t,{isLoggedIn:b,user:p,logout:N,checkAuth:w}=(0,u.n)(),{mode:y,toggleMode:C}=(0,m.C)(),L=(0,i.rd)(),_=(0,l.c)("common");(0,a.useEffect)(()=>{w()},[w]);let T=()=>{N(),L.push("/login")};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("nav",{className:"bg-card shadow-sm border-b border-border sticky top-0 z-50",children:(0,n.jsxs)("div",{className:"w-full mx-auto px-4 md:px-6 lg:px-8",children:[(0,n.jsxs)("div",{className:"flex justify-between h-14 md:h-16",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(i.N_,{href:f.href,className:"text-lg md:text-xl font-bold text-foreground shrink-0",children:f.name}),(0,n.jsx)("div",{className:"hidden lg:flex ml-6 space-x-8",children:x.map(e=>(0,n.jsx)(i.N_,{href:e.href,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors ".concat(r===e.href?"border-primary text-foreground":"border-transparent text-muted-foreground hover:border-border hover:text-foreground"),children:e.name},e.name))})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 md:gap-3 lg:gap-4",children:[(0,n.jsx)(h.$,{variant:"outline",size:"icon",onClick:C,"aria-label":"切换主题模式",title:"light"===y?"切换到暗色模式":"切换到亮色模式",className:"shrink-0",children:"light"===y?(0,n.jsx)(d.A,{className:"h-4 w-4 md:h-[1.2rem] md:w-[1.2rem]"}):(0,n.jsx)(c.A,{className:"h-4 w-4 md:h-[1.2rem] md:w-[1.2rem]"})}),(0,n.jsx)("div",{className:"hidden lg:block",children:(0,n.jsx)(k,{})}),(0,n.jsx)("div",{className:"hidden lg:flex items-center gap-4",children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-sm text-foreground",children:(null==p?void 0:p.username)?"".concat(_("welcome"),"，").concat(p.username):_("welcomeBack")}),(0,n.jsx)(h.$,{variant:"outline",onClick:T,className:"cursor-pointer",children:_("logout")})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.$,{variant:"outline",asChild:!0,children:(0,n.jsx)(i.N_,{href:v.login.href,children:v.login.text})}),(0,n.jsx)(h.$,{asChild:!0,children:(0,n.jsx)(i.N_,{href:v.register.href,children:v.register.text})})]})}),(0,n.jsx)("div",{className:"hidden md:flex lg:hidden items-center gap-3",children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-sm text-foreground",children:(null==p?void 0:p.username)?"".concat(_("welcome"),"，").concat(p.username):_("welcomeBack")}),(0,n.jsx)(h.$,{variant:"outline",onClick:T,className:"cursor-pointer",children:_("logout")})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.$,{variant:"outline",asChild:!0,children:(0,n.jsx)(i.N_,{href:v.login.href,children:v.login.text})}),(0,n.jsx)(h.$,{asChild:!0,children:(0,n.jsx)(i.N_,{href:v.register.href,children:v.register.text})})]})}),!b&&(0,n.jsx)(h.$,{size:"sm",variant:"outline",asChild:!0,className:"md:hidden",children:(0,n.jsx)(i.N_,{href:v.login.href,children:v.login.text})}),(0,n.jsx)("button",{onClick:()=>g(!o),className:"lg:hidden p-2 rounded-md text-muted-foreground hover:text-foreground hover:bg-accent transition-colors","aria-label":"Toggle menu",children:(0,n.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o?(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),o&&(0,n.jsx)("div",{className:"lg:hidden border-t border-border bg-card",children:(0,n.jsxs)("div",{className:"px-4 py-2 space-y-1",children:[x.map(e=>(0,n.jsx)(i.N_,{href:e.href,onClick:()=>g(!1),className:"block px-3 py-2 rounded-md text-base font-medium transition-colors ".concat(r===e.href?"bg-accent text-accent-foreground":"text-muted-foreground hover:bg-accent hover:text-foreground"),children:e.name},e.name)),b?(0,n.jsxs)("div",{className:"pt-2 border-t border-border",children:[(null==p?void 0:p.username)&&(0,n.jsxs)("p",{className:"px-3 py-2 text-sm text-muted-foreground",children:[_("welcome"),"，",p.username]}),(0,n.jsx)(h.$,{variant:"outline",onClick:()=>{T(),g(!1)},className:"w-full cursor-pointer",children:_("logout")})]}):(0,n.jsx)("div",{className:"pt-2 border-t border-border",children:(0,n.jsx)(h.$,{className:"w-full",asChild:!0,children:(0,n.jsx)(i.N_,{href:v.register.href,children:v.register.text})})})]})})]})}),(0,n.jsx)("div",{className:"md:hidden",children:(0,n.jsx)(j,{})})]})}},5839:(e,t,r)=>{"use strict";r.d(t,{n:()=>o});var n=r(9464),a=r(3008),s=r(3041);let o=(0,n.v)()((0,a.Zr)((e,t)=>({isLoggedIn:!1,token:null,user:null,login:(t,r,n)=>{(0,s.WG)(t,r),e({isLoggedIn:!0,token:t,user:n||null})},logout:()=>{(0,s.L)(),e({isLoggedIn:!1,token:null,user:null})},setUser:t=>{e({user:t})},checkAuth:()=>{let r=(0,s.gf)(),n=t();r&&!n.isLoggedIn?e({isLoggedIn:!0,token:r}):!r&&n.isLoggedIn&&e({isLoggedIn:!1,token:null,user:null})}}),{name:"auth-storage",storage:(0,a.KU)(()=>localStorage),partialize:e=>({user:e.user})}))},7068:(e,t,r)=>{Promise.resolve().then(r.bind(r,3327)),Promise.resolve().then(r.bind(r,1309))},7437:(e,t,r)=>{"use strict";r.d(t,{IB:()=>n,L$:()=>s,q:()=>a});let n=["en","zh"],a="en",s={en:"English",zh:"简体中文"}},7544:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var n=r(9700);r(1464);var a=r(5834),s=r(5661),o=r(1687);let i=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:r="default",size:s="default",asChild:l=!1,...d}=e,c=l?a.DX:"button";return(0,n.jsx)(c,{"data-slot":"button","data-variant":r,"data-size":s,className:(0,o.cn)(i({variant:r,size:s,className:t})),...d})}},9530:(e,t,r)=>{"use strict";r.d(t,{C:()=>s});var n=r(9464),a=r(3008);let s=(0,n.v)()((0,a.Zr)(e=>({themeName:"slate",mode:"light",setThemeName:t=>e({themeName:t}),setMode:t=>e({mode:t}),toggleMode:()=>e(e=>({mode:"light"===e.mode?"dark":"light"}))}),{name:"theme-storage"}))}},e=>{e.O(0,[4703,3144,8389,6923,617,8789,1290,7358],()=>e(e.s=7068)),_N_E=e.O()}]);
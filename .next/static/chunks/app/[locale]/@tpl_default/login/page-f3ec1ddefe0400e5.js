(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1002],{2013:(e,s,a)=>{Promise.resolve().then(a.bind(a,9809))},9809:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var r=a(9700),t=a(1464),l=a(3144),d=a.n(l),c=a(4944),n=a(2557),i=a(6821),o=a(5839),m=a(5229),x=a(3143),u=a(7544),h=a(10),p=a(1431),j=a(5399);function g(e){let{fullPage:s=!0}=e,a=(0,n.useRouter)(),l=(0,n.useSearchParams)(),g=(0,o.n)(e=>e.login),[f,y]=(0,t.useState)({username:"",password:"",code:""}),[N,v]=(0,t.useState)(""),[b,w]=(0,t.useState)(null),[_,k]=(0,t.useState)(!1),[S,C]=(0,t.useState)(!1),E=(0,m.zp)(l),R=async()=>{k(!0);try{let e=await (0,i.z8)();w(e)}catch(e){console.error("获取验证码失败:",e)}finally{k(!1)}};(0,t.useEffect)(()=>{R()},[]);let q=async e=>{if(e.preventDefault(),v(""),!(null==b?void 0:b.uuid)){v("请等待验证码加载完成"),x.oR.warning("请等待验证码加载完成");return}C(!0);try{let e=(0,i.vk)({username:f.username,password:f.password,code:f.code,uuid:b.uuid},{showErrorToast:!1});x.oR.promise(e,{loading:"登录中...",success:"登录成功！",error:e=>e.message||"登录失败，请检查用户名和密码"});let s=await e;g(s.data.access_token,s.data.expires_in);let r=(0,m.M3)(E,"/");a.push(r)}catch(e){console.log("error--\x3e",e),v(e.message||"登录失败，请检查用户名和密码"),R(),y(e=>({...e,code:""}))}finally{C(!1)}},z=e=>{let{name:s,value:a}=e.target;y(e=>({...e,[s]:a})),N&&v("")};return(0,r.jsx)("div",{className:s?"min-h-screen flex items-center justify-center px-4":"flex items-center justify-center px-4 py-8 md:py-12",children:(0,r.jsxs)(h.Zp,{className:"w-full max-w-md",children:[(0,r.jsxs)(h.aR,{className:"text-center",children:[(0,r.jsx)(h.ZB,{className:"text-2xl font-bold",children:"登录账户"}),(0,r.jsx)(h.BT,{children:"输入您的用户名和密码以访问您的账户"})]}),(0,r.jsxs)(h.Wu,{children:[(0,r.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"username",children:"用户名"}),(0,r.jsx)(p.p,{id:"username",name:"username",type:"text",placeholder:"请输入用户名",value:f.username,onChange:z,required:!0,disabled:S})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"password",children:"密码"}),(0,r.jsx)(p.p,{id:"password",name:"password",type:"password",placeholder:"请输入密码",value:f.password,onChange:z,required:!0,disabled:S})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"code",children:"验证码"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(p.p,{id:"code",name:"code",type:"text",placeholder:"请输入验证码",value:f.code,onChange:z,required:!0,disabled:S,className:"flex-1"}),(0,r.jsx)("div",{className:"w-32 h-10 border border-gray-300 rounded-md flex items-center justify-center bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>R(),title:"点击刷新验证码",children:_?(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"加载中..."}):(null==b?void 0:b.img)?(0,r.jsx)(c.default,{src:"data:image/png;base64,".concat(b.img),alt:"验证码",width:128,height:40,className:"w-full h-full object-cover rounded",unoptimized:!0}):(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"点击加载"})})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"点击验证码图片可刷新"})]}),N&&(0,r.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:N})}),(0,r.jsx)(u.$,{type:"submit",className:"w-full",disabled:S||_,children:S?"登录中...":"登录"})]}),(0,r.jsxs)("div",{className:"mt-6 text-center text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"还没有账户？"})," ",(0,r.jsx)(d(),{href:"/register",className:"text-blue-600 hover:text-blue-500 font-medium",children:"立即注册"})]}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsx)(d(),{href:"/",className:"text-sm text-gray-600 hover:text-gray-500",children:"返回首页"})})]})]})})}}},e=>{e.O(0,[4703,3144,8389,6499,5514,8789,1290,7358],()=>e(e.s=2013)),_N_E=e.O()}]);